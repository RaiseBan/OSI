### Отчет по лабораторной работе №1

---

#### Задание Часть 1. Реализация командной оболочки

**Цель:** Реализовать оболочку командной строки (shell) на ОС Windows, позволяющую запускать программы с переданными аргументами и подсчитывать реальное время их работы.

**Описание реализации:**
- Я реализовал оболочку командной строки, используя системный вызов `CreateProcessAsUser` для запуска программ.
- После завершения каждого процесса, оболочка фиксирует время завершения программы и рассчитывает общее время выполнения как разницу между временем запуска и завершения процесса.
- Операционная система: Windows.

**Пример запуска программы в оболочке:**
```shell
my_shell.exe
Enter command: binary_search.exe 100000 1 250000000
```

**Результат:**
```
Program execution time: X.XXXX sec
```

---

#### Задание Часть 2. Мониторинг и профилирование

**Цель:** Разработать программы-нагрузчики и проанализировать их производительность с помощью инструментов профилирования на Windows.

**Описание программ-нагрузчиков:**
1. **Бинарный поиск:** Программа выполняет бинарный поиск в отсортированном массиве заданного размера и повторяет поиск указанное количество раз.
   - **Параметры запуска:** `binary_search 100000 1 250000000`
   
2. **Поиск подстроки во внешней памяти:** Программа ищет заданную подстроку в большом файле (размером в несколько сотен мегабайт) и выполняет поиск несколько раз для симуляции нагрузки на дисковую подсистему.
   - **Параметры запуска:** `substring_search D:\large_text.txt R7 2`

**Код программ-нагрузчиков:**
```cpp
// binary_search.cpp

// substring_search.cpp
```

#### Предварительная оценка времени выполнения

На основании знаний о характеристиках процессора и дисковой подсистемы, а также логике алгоритмов, предполагается, что бинарный поиск с большим количеством повторений окажет основное влияние на загрузку CPU, тогда как поиск подстроки во внешней памяти – на нагрузку диска.

---

### Эксперименты и результаты профилирования

#### 1. Запуск программ-нагрузчиков и фиксация метрик работы

**Описание:** Запуск каждого нагрузчика отдельно, сбор метрик по CPU, памяти и вводу-выводу.

1. **Бинарный поиск:** 
   - **Параметры запуска:** `binary_search 100000 1 250000000`
   - **Метрики:** CPU, SYS, USER, WAIT, переключения контекста
   - **Скрин профилировщика бинарного поиска**

2. **Поиск подстроки:** 
   - **Параметры запуска:** `substring_search D:\large_text.txt R7 2`
   - **Метрики:** CPU, I/O, USER, SYS, переключения контекста
   - **Скрин профилировщика поиска подстроки**

**Сравнение с ожидаемыми результатами и объяснение:**  
Результаты профилирования показали, что бинарный поиск в основном загружает CPU, тогда как программа поиска подстроки оказывает значительную нагрузку на дисковую подсистему. Это совпадает с первоначальной оценкой.

---

#### 2. Определение количества нагрузчиков для полной загрузки CPU

**Описание эксперимента:** Запуск нескольких экземпляров каждого нагрузчика одновременно и определение, сколько экземпляров необходимо для полной загрузки всех ядер процессора.

- **Методика:** Запускать нагрузчики с помощью shell-скрипта, указав количество экземпляров.
- **Результаты:** 
  - Количество экземпляров для полной загрузки CPU: **X** (для бинарного поиска) и **Y** (для поиска подстроки).
  - **Скрин профилировщика с полным числом экземпляров**

**Показатели:**
- USER%: ___
- SYS%: ___
- WAIT%: ___
- Количество вынужденных переключений контекста: ___
- Количество невынужденных переключений контекста: ___

**Вывод:** С увеличением числа нагрузчиков, система достигает максимальной загрузки всех доступных ядер. Количество переключений контекста возросло, что свидетельствует о нагрузке на планировщик процессов.

---

#### 3. Увеличение числа нагрузчиков вдвое, втрое, вчетверо

**Описание эксперимента:** Увеличение числа экземпляров каждого нагрузчика и анализ изменения производительности.

- **Результаты:**
  - USER%: ___
  - SYS%: ___
  - WAIT%: ___
  - Реальное время выполнения: ___
  - **Скрин профилировщика с увеличенным числом экземпляров**

**Вывод:** При увеличении числа нагрузчиков, процессорные и системные нагрузки увеличиваются. Однако из-за ограничения ресурсов начинает расти WAIT%, что может свидетельствовать о конфликте ресурсов между процессами.

---

#### 4. Объединение нагрузчиков в одну программу с потоками

**Описание эксперимента:** Объединение бинарного поиска и поиска подстроки в одну программу с использованием потоков, что позволяет одному процессу загружать все ядра системы.

- **Методика:** Программа создает два потока – один для выполнения бинарного поиска, другой – для поиска подстроки.
- **Результаты:**
  - USER%: ___
  - SYS%: ___
  - WAIT%: ___
  - Реальное время выполнения: ___
  - **Скрин профилировщика с использованием потоков**

**Вывод:** Использование потоков для параллельной обработки показало более эффективное распределение нагрузки на ядра CPU, что позволило сократить реальное время выполнения.

---

#### 5. Включение агрессивной оптимизации компилятора

**Описание эксперимента:** Скомпилировать программу с агрессивными опциями оптимизации (например, `-O2` или `-O3`) и измерить реальное время выполнения.

- **Результаты:**
  - Реальное время выполнения программы после оптимизации: ___
  - **Скрин профилировщика оптимизированной версии**

**Вывод:** Оптимизация компиляции значительно сократила время выполнения программы за счет улучшения производительности кода. Это подтверждает эффективность компиляторских оптимизаций при работе с интенсивными вычислениями.

---

### Заключение

В ходе лабораторной работы была реализована оболочка командной строки для запуска программ, а также программы-нагрузчики для измерения производительности системы. Проведенные эксперименты показали, как изменяется поведение системы при увеличении нагрузки, использовании многопоточности и оптимизаций компилятора. Инструменты профилирования позволили зафиксировать метрики, такие как USER%, SYS%, WAIT%, количество переключений контекста и другие параметры, что дало представление о влиянии каждой программы на ресурсы системы. 

**Дополнительно:**
- **Таблица результатов для каждой конфигурации (будет добавлена после завершения анализа).**
- **Скриншоты профилировщика для каждой конфигурации (будут добавлены в отчёт).**
